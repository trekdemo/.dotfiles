#!/bin/sh

#
# Accepts a Markdown-formatted file and outputs a PDF. Will replace the .md
# file extension with .pdf, or append .pdf if no .md extension is found.
#
# markdown can be installed on Mac OS X using Homebrew. A wkhtmltopdf binary
# is available on Google Code.
#
#     Markdown: http://daringfireball.net/projects/markdown/syntax
#     Homebrew: http://mxcl.github.com/homebrew/
#     wkhtmltopdf: http://code.google.com/p/wkhtmltopdf/
#

BASENAME=$(basename $0)

if [ -z "$1" ]; then
    echo "Usage: $BASENAME file.md"
    exit 1
fi

SRCFILE="$1"

DSTFILE=$(basename "$SRCFILE" .md)
DSTFILE="$DSTFILE.html"

echo "Converting $SRCFILE to $DSTFILE..."

{
    echo "<head><title>$SRCFILE</title><meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\" /><style>"
    cat "$HOME/bin/markdown.css"
    echo "</style></head>"
    markdown "$SRCFILE"
} > "$DSTFILE"
